"use strict";(self.webpackChunkai=self.webpackChunkai||[]).push([[671],{8659:(e,t,s)=>{s.d(t,{A3:()=>c,lu:()=>d,or:()=>g,NK:()=>v,zP:()=>A,C6:()=>I,bc:()=>w,CG:()=>p,Xs:()=>y,g$:()=>j,Ec:()=>f,Vx:()=>m,l3:()=>h,c_:()=>S,H_:()=>u,Dt:()=>x,qv:()=>b,J2:()=>l});var i=s(6213),r=s(2019);const n=e=>{if(e.response){const{status:t}=e.response;switch(!0){case t>=200&&t<300:break;case t>=500&&t<600:r.Ay.error("\u670d\u52a1\u5668\u9519\u8bef: ".concat(t));break;case 403===t:r.Ay.error("\u7981\u6b62\u8bbf\u95ee: 403 Forbidden");break;case 404===t:r.Ay.error("\u672a\u627e\u5230: 404 Not Found");break;default:r.Ay.error("\u9519\u8bef\u72b6\u6001\u7801: ".concat(t))}}else e.request?r.Ay.error("\u8bf7\u6c42\u53d1\u51fa, \u7f51\u7edc\u9519\u8bef"):r.Ay.error("\u8bf7\u6c42\u9519\u8bef: "+e.message)},a=i.A.create({baseURL:"http://10.21.56.119:8082",timeout:5e3,headers:{"Content-Type":"application/json"},responseType:"json"});a.interceptors.request.use((e=>{const t=localStorage.getItem("token");return t&&(e.headers.Authorization="Bearer ".concat(t)),e}),(e=>Promise.reject(e))),a.interceptors.response.use((e=>e.data),(e=>(n(e),Promise.reject(e))));const o=a;function l(e){return o({url:"/account/register/sendVerificationCode",method:"post",data:{email:e}})}function c(e,t,s){return o({url:"/account/register",method:"post",data:{email:e,password:t,verificationCode:s}})}function d(e,t){return o({url:"/account/login",method:"post",data:{email:e,password:t}})}function u(){return o({url:"/mission/queryUserCanUseModel?userId=".concat(localStorage.getItem("userId")),method:"get"})}function m(){return o({url:"/model/modelRank",method:"get"})}function p(e){return o({url:"/application/myApplicationCount",method:"get",params:{userId:e}})}function h(e){return o({url:"/mission/homePageRecentMission",method:"get",params:{userId:e}})}function x(e){return o({url:"/model/allModels",method:"get",params:{userId:e,page:arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,name:arguments.length>2&&void 0!==arguments[2]?arguments[2]:""}})}function g(e){return o({url:"/account/homePageInfo",method:"get",params:{userId:e}})}function j(e,t){return o({url:"/application/receivedApplication",method:"get",params:{userId:e,page:t}})}function f(e,t){return o({url:"/model/myModel",method:"get",params:{userId:e,page:t}})}function y(e,t){return o({url:"/application/myApplication",method:"get",params:{userId:e,page:t}})}function v(e){return o({url:"/account/personalCenterInfo",method:"get",params:{userId:e}})}function A(e){return o({url:"/application/passApplication",method:"post",data:{applicationId:e}})}function w(e){return o({url:"/application/rejectApplication",method:"post",data:{applicationId:e}})}function I(e,t){return o({url:"/application/applyModel",method:"post",data:{modelId:e,userId:t}})}function S(){return o({url:"/mission/workspaceMission?userId=".concat(localStorage.getItem("userId")),method:"get"})}function b(e){return o({url:"/mission/saveMission",method:"post",data:e})}},7671:(e,t,s)=>{s.r(t),s.d(t,{default:()=>q});var i=s(9073),r=s(2918),n=s(4417),a=s(7021),o=s(5337),l=s(8677),c=s(5043),d=s(579);const u=e=>{let{missionId:t,items:s}=e;s[t]=s[t]||{};const[i,r]=(0,c.useState)(!1);return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(a.Ay,{type:"primary",onClick:()=>{r(!0)},children:"\u67e5\u770b\u7ed3\u679c"}),(0,d.jsx)(l.A,{title:"\u67e5\u770b\u7ed3\u679c",onClose:()=>{r(!1)},open:i,size:"large",children:(()=>{return s[t]?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("p",{children:"\u8f93\u5165\uff1a"}),(0,d.jsx)("p",{children:s[t].content?s[t].content:s[t].image?(0,d.jsx)("img",{src:s[t].image,style:{width:"80%",height:"auto"}}):null}),(0,d.jsx)("br",{}),(0,d.jsx)("p",{children:"\u8f93\u51fa\uff1a"}),(0,d.jsx)("p",{children:(e=s[t].answer,"string"===typeof e&&null!=e.match(/\.(jpeg|jpg|gif|png)$/)?(0,d.jsx)("img",{src:s[t].answer,alt:"answer",style:{width:"100%",height:"auto"}}):s[t].answer)})]}):(0,d.jsx)("p",{children:"\u6570\u636e\u672a\u52a0\u8f7d"});var e})()})]})};var m=s(8659);const p=e=>{let{flash:t,missionId:s,setMissionId:l,items:p,setItems:h,setMissionListData:x}=e;const[g,j]=(0,c.useState)(!1),[f,y]=(0,c.useState)(!1),[v,A]=(0,c.useState)(""),[w,I]=(0,c.useState)([]),[S,b]=(0,c.useState)(null);(0,c.useEffect)((()=>{(async()=>{try{const e=await(0,m.c_)();h(e.data)}catch(e){console.error("Error fetching task history:",e)}})()}),[t]),(0,c.useEffect)((()=>{const e=p.map(((e,t)=>{let{missionName:s}=e;return{missionName:s,index:t}}));I(e)}),[p]);return(0,d.jsxs)("div",{className:"project",children:[(0,d.jsxs)("div",{className:"TwoButton",style:{display:"flex",gap:"5px"},children:[(0,d.jsx)(a.Ay,{className:"add",icon:(0,d.jsx)(o.A,{}),type:"text",style:{flexGrow:1},onClick:()=>{j(!0)},children:"\u65b0\u5efa\u9879\u76ee"}),(0,d.jsx)(r.A,{title:"\u9879\u76ee\u540d",open:g,onOk:()=>{y(!0),setTimeout((()=>{j(!1),y(!1)}),2e3)},confirmLoading:f,onCancel:()=>{j(!1)},okText:"\u63d0\u4ea4",cancelText:"\u53d6\u6d88",children:(0,d.jsx)(n.A,{placeholder:"\u8bf7\u8f93\u5165\u9879\u76ee\u540d",value:v,onChange:e=>A(e.target.value)})}),(0,d.jsx)(u,{missionId:s,items:p})]}),w.map(((e,t)=>{let{missionName:s}=e;return(0,d.jsx)(i.A,{style:{width:210,marginTop:16,backgroundColor:S===t?"#f0f0f0":"#fff",border:S===t?"2px solid #1890ff":"1px solid #d9d9d9"},children:(0,d.jsx)("h4",{onClick:()=>{((e,t)=>{l(e),b(t),x(p[t])})(t,t)},style:{cursor:"pointer"},children:s},t)})}))]})};var h=s(6597),x=s(2019),g=s(5786),j=s(6036),f=s(7419),y=s(1645),v=s(8167),A=s(898),w=s(9748),I=s(1966),S=s(6213);const b=function(){return(0,d.jsx)("div",{className:"fullscreen-overlay",children:(0,d.jsxs)("div",{id:"wifi-loader",children:[(0,d.jsxs)("svg",{class:"circle-outer",viewBox:"0 0 86 86",children:[(0,d.jsx)("circle",{class:"back",cx:"43",cy:"43",r:"40"}),(0,d.jsx)("circle",{class:"front",cx:"43",cy:"43",r:"40"}),(0,d.jsx)("circle",{class:"new",cx:"43",cy:"43",r:"40"})]}),(0,d.jsxs)("svg",{class:"circle-middle",viewBox:"0 0 60 60",children:[(0,d.jsx)("circle",{class:"back",cx:"30",cy:"30",r:"27"}),(0,d.jsx)("circle",{class:"front",cx:"30",cy:"30",r:"27"})]}),(0,d.jsxs)("svg",{class:"circle-inner",viewBox:"0 0 34 34",children:[(0,d.jsx)("circle",{class:"back",cx:"17",cy:"17",r:"14"}),(0,d.jsx)("circle",{class:"front",cx:"17",cy:"17",r:"14"})]}),(0,d.jsx)("div",{class:"text","data-text":"Searching"})]})})},k=e=>{let{dataresult:t,setFlash:s,flash:i,rawList:r}=e;const[u,p]=(0,c.useState)(!1),[h,g]=(0,c.useState)([]),[k]=w.A.useForm(),[C,L]=(0,c.useState)(!1),[N,T]=(0,c.useState)("auto"),F=()=>{p(!1),k.resetFields(),g([])};return C?(0,d.jsx)(b,{}):(0,d.jsxs)("div",{children:[(0,d.jsx)(a.Ay,{type:"primary",onClick:()=>{p(!0)},icon:(0,d.jsx)(o.A,{}),children:"\u4e0a\u4f20"}),(0,d.jsxs)(l.A,{title:"\u8fd0\u884c\u9879\u76ee",width:720,onClose:F,open:u,bodyStyle:{paddingBottom:80},extra:(0,d.jsxs)(A.A,{children:[(0,d.jsx)(a.Ay,{onClick:F,children:"\u53d6\u6d88"}),(0,d.jsx)(a.Ay,{onClick:()=>k.submit(),type:"primary",children:"\u8fd0\u884c"})]}),children:[(0,d.jsxs)(v.Ay.Group,{value:N,onChange:e=>T(e.target.value),style:{marginBottom:"20px"},children:[(0,d.jsx)(v.Ay.Button,{value:"auto",children:"\u667a\u80fd\u9009\u62e9"}),(0,d.jsx)(v.Ay.Button,{value:"Server1",children:"\u670d\u52a1\u56681"}),(0,d.jsx)(v.Ay.Button,{value:"Server2",children:"\u670d\u52a1\u56682"})]}),(0,d.jsxs)(w.A,{form:k,layout:"vertical",hideRequiredMark:!0,onFinish:async e=>{const{description:n}=e;if(!n&&0===h.length)return void x.Ay.warning("\u8bf7\u8f93\u5165\u6587\u672c\u6216\u4e0a\u4f20\u56fe\u7247\uff0c\u4e8c\u8005\u5fc5\u9009\u5176\u4e00");if(n&&h.length>0)return void x.Ay.warning("\u53ea\u80fd\u9009\u62e9\u6587\u672c\u6216\u56fe\u7247\uff0c\u4e0d\u80fd\u540c\u65f6\u9009\u62e9");const a=new FormData;h.forEach((e=>{a.append("multipartFile",e.originFileObj)}));try{let o=null;h.length>0&&(o=await S.A.post("http://10.21.56.119:8082/upload",a,{headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer ".concat(localStorage.getItem("token"))}}));let l={image:o?o.data.data:"",content:n||"",modelList:t,answer:"",errorText:""};L(!0);let c=null,d=null,u=null;if("auto"===N?(c=await S.A.get("http://10.21.56.118:11451/get_cpu_usage"),d=await S.A.get("http://10.21.56.119:11451/get_cpu_usage"),u=c.data<=d.data?"http://10.21.56.118:11451/post_json":"http://10.21.56.119:11451/post_json"):"Server1"===N?u="http://10.21.56.118:11451/post_json":"Server2"===N&&(u="http://10.21.56.119:11451/post_json"),o=await S.A.post(u,l,{headers:{"Content-Type":"application/json"}}),o.data.errorText)return x.Ay.error(o.data.errorText),void L(!1);o=o.data,l={...l,answer:o.answer,missionName:e.missionName,userId:localStorage.getItem("userId"),modelList:JSON.stringify(r),formattedModelList:t},await(0,m.qv)(l),F(),L(!1),x.Ay.success("\u6210\u529f\u5566,\u8bf7\u70b9\u51fb\u67e5\u770b\u7ed3\u679c~"),s(!i)}catch(o){L(!1),x.Ay.error("Upload failed"),console.error("Error:",o)}},children:[(0,d.jsx)(w.A.Item,{label:"\u9879\u76ee\u540d\u79f0",name:"missionName",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u9879\u76ee\u540d\u5b57"}],children:(0,d.jsx)(n.A,{})}),(0,d.jsx)(f.A,{gutter:16,children:(0,d.jsx)(y.A,{span:24,children:(0,d.jsx)(w.A.Item,{name:"description",label:"\u8bf7\u8f93\u5165\u6587\u672c",rules:[{message:"\u8bf7\u8f93\u5165\u6587\u672c"}],children:(0,d.jsx)(n.A.TextArea,{rows:4})})})}),(0,d.jsx)(w.A.Item,{name:"hiddenData",initialValue:t,hidden:!0,children:(0,d.jsx)(n.A,{})}),(0,d.jsxs)(w.A.Item,{label:"\u4e0a\u4f20\u56fe\u7247",valuePropName:"fileList",getValueFromEvent:e=>Array.isArray(e)?e:null===e||void 0===e?void 0:e.fileList,children:[(0,d.jsx)(j.A,{listType:"picture-card",fileList:h,beforeUpload:()=>!1,onChange:e=>{var t;let{fileList:s}=e;if(s.length>1)return void x.Ay.warning("\u53ea\u80fd\u4e0a\u4f20\u4e00\u5f20\u56fe\u7247");(null===(t=s[0])||void 0===t?void 0:t.type.startsWith("image/"))?g(s):x.Ay.warning("\u53ea\u80fd\u4e0a\u4f20\u56fe\u7247\u6587\u4ef6")},maxCount:1,accept:"image/*",children:(0,d.jsxs)("button",{style:{border:0,background:"none"},type:"button",children:[(0,d.jsx)(o.A,{}),(0,d.jsx)("div",{style:{marginTop:8},children:"Upload"})]})}),h.length>0&&(0,d.jsx)(a.Ay,{icon:(0,d.jsx)(I.A,{}),onClick:()=>{g([])},style:{marginLeft:16},children:"\u53d6\u6d88\u4e0a\u4f20"})]})]})]})]},1)};var C=s(8855),L=s(6886);const N=e=>{let{Name:t,modelId:s,setLists:i,weight:o,lists:l,index:u,question:m}=e;const[p,h]=(0,c.useState)(!1),[x,g]=(0,c.useState)(!1),[j,f]=(0,c.useState)(o),[y,v]=(0,c.useState)(m),A=(e,t,s,i)=>e.map((e=>e.modelId===t?{...e,weight:s,question:i}:e));return(0,d.jsxs)("div",{children:[(0,d.jsx)(a.Ay,{type:"primary",onClick:()=>{h(!0)},style:{width:"100%"},children:(0,d.jsx)("span",{style:{display:"block",maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t})}),(0,d.jsxs)(r.A,{title:"\u81ea\u5b9a\u4e49\u4fe1\u606f",open:p,onOk:()=>{const e=A(l[u].items,s,j,y);i(l.map(((t,s)=>s===u?{...t,items:e}:t))),g(!0),setTimeout((()=>{h(!1),g(!1)}),1e3)},confirmLoading:x,onCancel:()=>{console.log("Clicked cancel button"),h(!1)},okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",children:[(0,d.jsx)(n.A,{placeholder:"\u8bf7\u8f93\u5165\u6743\u91cd",prefix:(0,d.jsx)(C.A,{}),value:j,onChange:e=>{const t=e.target.value,s=!isNaN(t)&&t.indexOf(".")===t.lastIndexOf(".")&&t.split(".").length-1<=1;f(s?t:"")},pattern:"\\d+(\\.\\d{0,})?",title:"\u8bf7\u8f93\u5165\u6743\u91cd\uff08\u6570\u5b57\u6216\u5c0f\u6570\uff09",required:!0}),m&&(0,d.jsx)(n.A,{placeholder:"\u8bf7\u8f93\u5165\u63d0\u793a\u8bcd",prefix:(0,d.jsx)(L.A,{}),style:{marginTop:"10px"},value:y,onChange:e=>{const t=e.target.value;v(t)},title:"\u8bf7\u8f93\u5165\u63d0\u793a\u8bcd"})]})]})},T=e=>{let{item:t,lists:s,setLists:r,index:n}=e;return(0,d.jsx)("p",{title:t.description,children:(0,d.jsx)(i.A,{hoverable:!0,size:"small",style:{marginBottom:"12px"},children:(0,d.jsx)(N,{Name:t.modelName,weight:t.weight,modelId:t.modelId,lists:s,setLists:r,index:n,question:t.question})},t.id)})},F=e=>{var t;let{setFlash:s,flash:r,MissionListData:n}=e;const[o,l]=(0,c.useState)([]);(0,c.useEffect)((()=>{(async()=>{const e=(await(0,m.H_)()).data;console.log(e);const t=e.map((e=>({...e,...1===e.isAPI?{question:"123"}:{}})));l(t)})()}),[]);const[u,p]=(0,c.useState)([]),j=n.modelList?JSON.parse(n.modelList):[];(0,c.useEffect)((()=>{p([{id:1,items:o}])}),[o]),(0,c.useEffect)((()=>{j&&(p([{id:1,items:o}]),p((e=>[...e,...j])))}),[n]);const f=e=>{console.log("Drag ended:",e)},[y,v]=(0,c.useState)([]);(0,c.useEffect)((()=>{const e=u.filter(((e,t)=>t>0)).filter((e=>e.items.length>0)).map(((e,t)=>({layer:t+1,parallel:e.items.length>1?1:0,models:e.items.map((e=>({modelName:e.modelName,modelUrl:e.modelUrl,isAPI:e.isAPI,weight:e.weight,question:e.question})))})));v(e)}),[u]);const[A,...w]=u;null===A||void 0===A||A.items.sort(((e,t)=>e.isAPI-t.isAPI));const S=null===A||void 0===A||null===(t=A.items)||void 0===t?void 0:t.findIndex((e=>1===(null===e||void 0===e?void 0:e.isAPI)));console.log(S);const b=(e,t)=>{const s=[...u];console.log(e),s[t].items=e,p(s)},C=y;return console.log(C),(0,d.jsxs)("div",{style:{display:"flex",marginTop:"5px",flexGrow:1,gap:"10px"},children:[(0,d.jsxs)("div",{style:{flex:"0 0 220px",padding:"0 10px",minWidth:"15vw",position:"relative"},children:[(0,d.jsx)(g.ReactSortable,{list:[],setList:()=>{},group:{name:"shared",pull:!1,put:!0},children:(0,d.jsx)(I.A,{style:{position:"absolute",top:"20px",right:"30px",zIndex:"10",fontSize:"18px"}})}),A&&(0,d.jsxs)(i.A,{title:"\u6a21\u578b\u5e93",bordered:!1,style:{height:"100vh",overflowY:"auto",minWidth:"220px"},children:[(0,d.jsxs)("div",{style:{display:"flex"},children:[(0,d.jsx)(a.Ay,{onClick:()=>{if(u.some((e=>0===e.items.length)))return void x.Ay.error("\u5f53\u524d\u5217\u8868\u4e2d\u5b58\u5728\u7a7a\u5217\u8868\uff0c\u65e0\u6cd5\u6dfb\u52a0\u65b0\u7684\u5217\u8868");const e=u.length+1;p([...u,{id:e,items:[]}])},type:"primary",style:{marginBottom:20,marginRight:"10px",flex:"1"},children:"\u589e\u52a0\u5c42\u7ea7"}),(0,d.jsx)(k,{style:{flex:"1"},dataresult:C,setFlash:s,flash:r,rawList:w})]}),(0,d.jsx)(g.ReactSortable,{list:A.items,setList:e=>b(e,0),onEnd:f,group:{name:"shared",pull:"clone",put:!1},clone:e=>({...e,id:e.id?e.id:(new Date).getTime()}),className:"list".concat(A.id),style:{height:"100%"},children:A.items.map(((e,t)=>{const s=t===S;return(0,d.jsxs)(c.Fragment,{children:[s&&(0,d.jsx)("div",{className:"with-separator",children:(0,d.jsx)(T,{item:e,lists:u,setLists:p,index:0})}),!s&&(0,d.jsx)(T,{item:e,lists:u,setLists:p,index:0})]},e.id)}))})]})]}),(0,d.jsx)("div",{style:{flex:"auto",padding:"0 10px",overflowY:"auto"},children:(0,d.jsx)(h.A,{gap:20,wrap:!0,vertical:!0,style:{maxHeight:"95vh"},justify:"center",children:w.map(((e,t)=>(0,d.jsx)(i.A,{title:"\u5c42\u7ea7:".concat(t+1),bordered:!1,style:{minHeight:"10vh",minWidth:"10vw",maxWidth:"15vw",height:"auto",overflowY:"auto"},children:(0,d.jsx)(g.ReactSortable,{list:e.items,setList:e=>b(e,t+1),onEnd:f,group:{name:"shared",put:["shared"]},className:"list".concat(e.id),style:{height:"100%"},children:e.items.map((e=>(0,d.jsx)(T,{item:e,lists:u,setLists:p,index:t+1},e.id)))})})))})})]})},q=()=>{const[e,t]=(0,c.useState)(!1),[s,i]=(0,c.useState)([]),[r,n]=(0,c.useState)(null),[a,o]=(0,c.useState)([]);return(0,d.jsxs)("div",{className:"workbench",children:[(0,d.jsx)("div",{className:"work_project",children:(0,d.jsx)(p,{flash:e,missionId:r,setMissionId:n,items:s,setItems:i,setMissionListData:o})}),(0,d.jsx)(F,{setFlash:t,flash:e,MissionListData:a})]})}}}]);
//# sourceMappingURL=671.c5131e1d.chunk.js.map